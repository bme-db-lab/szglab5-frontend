<div class="content evaluator">
  {{left-menu title="Corrector" currentView=currentView goToView=(action 'goToView') subMenu=subMenu}}
  <div class="right">
    <div class="evaluator">
      {{#unless currentView}}
        <div class="text label">Help</div>
        <div class="text">First select a deliverable for grading. If you are accepted then you can correct it from the grading menu.</div>
      {{/unless}}
      {{#if (eq currentView 'select')}}
        {{#unless selectedType}}
            <div class="text label">Exercise type:</div>
            {{#power-select options=ExerciseTypes selected=selectedType onchange=(action "changeType") as |type|}}
              {{type.name}}
            {{/power-select}}
        {{else}}
          {{#unless selectedSheet}}
            <div class="breadcrumb">
                <button {{action 'back'}}><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
              {{selectedType.name}}
            </div>
            <div class="text label">Exercise category:</div>
            {{#power-select options=selectedType.ExerciseCategoriesSelect selected=selectedSheet onchange=(action "changeSheet") as |sheet|}}
              {{sheet.value}}
            {{/power-select}}
          {{else}}
            {{#unless selectedEvent}}
              <div class="breadcrumb">
                <button {{action 'back'}}><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
                {{selectedType.name}} / {{selectedSheet.ExerciseCategory.type}}
              </div>
              {{table-component withoutNumber=true header=header body=events rowIndecies=rowIndecies clickable=true changeEvent=(action 'changeEvent') onClickRowAction='changeEvent'}}
            {{else}}
              {{#unless selectedDeliverable}}
                <div class="breadcrumb">
                  <button {{action 'back'}}><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
                  {{selectedType.name}} / {{selectedSheet.ExerciseCategory.type}} / {{selectedEventUser.displayName}} ({{selectedEventUser.neptun}})
                </div>
                <div class="text label">Deliverable:</div>
                {{#power-select options=selectedEvent.correctableDeliverables selected=selectedDeliverable onchange=(action "changeDeliverable") as |Deliverable|}}
                  {{Deliverable.DeliverableTemplate.description}}
                {{/power-select}}
              {{else}}
                <div class="breadcrumb">
                  <button {{action 'back'}}><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
                  {{selectedType.name}} / {{selectedSheet.ExerciseCategory.type}} / {{selectedEventUser.displayName}} ({{selectedEventUser.neptun}}) / {{selectedDeliverable.DeliverableTemplate.description}}
                </div>
                <div class="text label">Deadline</div>
                <div class="text">{{dateformat selectedDeliverable.deadline}}</div>
                {{#if selectedDeliverable.isOver}}
                  <div class="text label">Select for grading</div>
                  {{#unless (eq selectedDeliverable.Corrector.id model.user.id)}}
                    {{#if selectedDeliverable.Corrector.id}}
                      <div class="text">Sorry, someone else have chosen this for grading.</div>
                    {{else}}
                      <div class="text">Noone is selected.</div>
                    {{/if}}
                  {{else}}
                    <div class="text">You are selected for grading. Go to the grading menu to start grading.</div>
                  {{/unless}}
                  <div class="text label">Select for grading</div>
                  <button type="button" class="btn--toggle {{if selectedDeliverable.gradingCache 'active'}}" {{action 'toggleGrading'}}>grading</button><br/>
                  <button type="button" {{action 'save'}}>Save</button>
                  {{#if success}}
                    <div class="success-box">
                      Saved successfully.
                    </div>
                  {{else}}
                    {{#unless (or (eq error '') (eq error undefined))}}
                      <div class="error-box">
                        {{error}}
                      </div>
                    {{/unless}}
                  {{/if}}
                {{else}}
                  <div class="text">This event has not reached its deadline.</div>
                {{/if}}
              {{/unless}}
            {{/unless}}
          {{/unless}}
        {{/unless}}
      {{/if}}
      {{#if (eq currentView 'grading')}}
        {{#unless selectedDeliverable}}
          {{#power-select options=deliverableFilters selected=selectedDeliverableFilter onchange=(action "changeDeliverableFilter") as |filter|}}
            {{filter.value}}
          {{/power-select}}
          {{#if filteredDeliverables}}
            {{table-component withoutNumber=true header=headerGrading body=filteredDeliverables rowIndecies=rowIndeciesGrading clickable=true changeEvent=(action 'changeDeliverableFromGrading') onClickRowAction='changeEvent'}}
          {{/if}}
        {{else}}
          <div class="breadcrumb">
            <button {{action 'backFromGrading'}}><i class="fa fa-arrow-left" aria-hidden="true"></i></button>
          </div>
          {{#unless (eq selectedDeliverable.Corrector.id model.user.id)}}
            <div class="text">Sorry, you have not been chosen this for grading. First select this for grading.</div>
          {{else}}
            <div class="text label">Event name and deliverable description:</div>
            <div class="text">{{selectedEvent.EventTemplate.name}} {{selectedDeliverable.DeliverableTemplate.description}}</div>
            <div class="text label">Student</div>
            <div class="text">{{selectedEventUser.displayName}} ({{selectedEventUser.neptun}})</div>
            <div class="text label">Deadline</div>
            <div class="text">{{dateformat selectedDeliverable.deadline}}</div>
            <div class="text label">Delayed</div>
            <div class="text">{{#if selectedDeliverable.isDelayed}}Yes, {{dateformat selectedDeliverable.lastSubmittedDate}}. {{else}} No. {{/if}}</div>
            <div class="text label">File</div>
            <div class="text">{{#if selectedDeliverable.uploaded}}<a class="button" {{action 'download'}}>Download</a>{{else}}Not uploaded.{{/if}}</div>
            <div class="text label">Grade</div>
            {{input type=nubmer value=selectedDeliverable.grade placeholder="grade"}}
            <div class="text label">Comment</div>
            {{textarea value=selectedDeliverable.comment cols="9" rows="9" placeholder="comment" }}
            <div class="text label">IMSC</div>
            {{input type=nubmer value=selectedDeliverable.imsc placeholder="imsc"}}
            <button type="button" class="btn--toggle {{if selectedDeliverable.finalized 'active'}}" {{action 'toggleFinalized'}}>finalized</button><br/>
            <button type="button" {{action 'save'}}>Save</button>
            {{#if success}}
              <div class="success-box">
                Saved successfully.
              </div>
            {{else}}
              {{#unless (or (eq error '') (eq error undefined))}}
                <div class="error-box">
                  {{error}}
                </div>
              {{/unless}}
            {{/if}}
          {{/unless}}
        {{/unless}}
      {{/if}}
    </div>
  </div>
</div>
